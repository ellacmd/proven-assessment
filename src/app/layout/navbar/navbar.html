<nav>
  <img src="/logo.svg" alt="" />

  <ul class="desktop-nav">
    <li>About Us</li>
    <li>Pricing</li>

    @if (!isAuthenticated() || !isOnProfileRoute()) {
    <li>
      <button class="primary-button signin-button" (click)="onSignInClick()">Sign In</button>
    </li>
    } @else {
    <li class="user-profile">
      <button [matMenuTriggerFor]="userMenu" class="user-menu-trigger">
        @if (currentUser()?.avatar_url) {
        <img
          [src]="
            (currentUser()?.avatar_url || '') +
            (currentUser()?.updated_at ? '?v=' + currentUser()?.updated_at : '')
          "
          [alt]="currentUser()?.username"
          class="user-avatar"
        />
        } @if (isOnProfileRoute()) {
        <span class="user-name">{{ currentUser()?.username | truncate : 15 }}</span>
        }
        <img src="/arrow-down.svg" alt="dropdown" class="dropdown-icon" />
      </button>
      <mat-menu #userMenu="matMenu" class="user-dropdown">
        <button mat-menu-item (click)="onProfileClick()">
          <mat-icon fontIcon="person"></mat-icon>
          <span>Profile</span>
        </button>
        <button mat-menu-item (click)="onEditProfileClick()">
          <mat-icon fontIcon="edit"></mat-icon>
          <span>Edit Profile</span>
        </button>
        <button mat-menu-item (click)="onLogoutClick()">
          <mat-icon fontIcon="logout"></mat-icon>
          <span>Logout</span>
        </button>
      </mat-menu>
    </li>
    } @if (isAuthenticated() && isOnProfileRoute()) {
    <li>
      <mat-icon aria-hidden="false" aria-label="Search icon" fontIcon="search"></mat-icon>
    </li>
    }
  </ul>

  <button class="hamburger-btn" (click)="toggleDrawer()" aria-label="Toggle navigation menu">
    <mat-icon fontIcon="menu"></mat-icon>
  </button>
</nav>

<div class="drawer-backdrop" [class.active]="drawerOpened()" (click)="toggleDrawer()"></div>
<div class="mobile-drawer" [class.open]="drawerOpened()">
  <mat-nav-list class="mobile-nav-list">
    <a mat-list-item (click)="toggleDrawer()">About Us</a>
    <a mat-list-item (click)="toggleDrawer()">Pricing</a>

    @if (!isAuthenticated() || !isOnProfileRoute()) {
    <a mat-list-item (click)="onSignInClick(); toggleDrawer()"> Sign In </a>
    } @else {
    <div class="mobile-user-profile">
      <div class="mobile-user-info">
        @if (currentUser()?.avatar_url) {
        <img
          [src]="
            (currentUser()?.avatar_url || '') +
            (currentUser()?.updated_at ? '?v=' + currentUser()?.updated_at : '')
          "
          [alt]="currentUser()?.username"
          class="mobile-user-avatar"
        />
        }
        <div class="mobile-user-details">
          @if (isOnProfileRoute()) {
          <span class="mobile-user-name">{{ currentUser()?.username | truncate : 15 }}</span>
          }
          <span class="mobile-user-email">{{ currentUser()?.email }}</span>
        </div>
      </div>
    </div>
    <a class="search-item" (click)="onProfileClick(); toggleDrawer()">
      <mat-icon fontIcon="person"></mat-icon>
      <span>Profile</span>
    </a>
    <a class="search-item" (click)="onEditProfileClick(); toggleDrawer()">
      <mat-icon fontIcon="edit"></mat-icon>
      <span>Edit Profile</span>
    </a>
    <a class="search-item" (click)="onLogoutClick(); toggleDrawer()">
      <mat-icon fontIcon="logout"></mat-icon>
      <span>Logout</span>
    </a>
    } @if (isAuthenticated() && isOnProfileRoute()) {
    <div (click)="toggleDrawer()" class="search-item">
      <mat-icon aria-hidden="false" aria-label="Search icon" fontIcon="search"></mat-icon>
      <span>Search</span>
    </div>
    }
  </mat-nav-list>
</div>
